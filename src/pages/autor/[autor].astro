---
import type { GetStaticPaths } from "astro";
import MainLayout from "@layouts/MainLayout.astro";
import { getCollection } from "astro:content";
import BlogPost from "@components/BlogPost.astro";

export const getStaticPaths = (async () => {
    //const autores = await getCollection("autor");
    //const posts = await getCollection("blog");
    const [autores, posts] = await Promise.all([
        getCollection("autor"),
        getCollection("blog")
    ]);
    
    return autores.map( (autor) => ({
        params: { autor: autor.id },
        props: {
            blogPosts: posts.filter( (post) => post.data.autor.id === autor.id ),
            autor: autor.data
        }
    }) );
}) satisfies GetStaticPaths;

const { blogPosts, autor } = Astro.props;

---

<MainLayout>
	<section class="bg-white dark:bg-gray-900">
		<div class="container px-6 py-10 mx-auto">
			<h1 class="text-3xl font-semibold text-gray-800 lg:text-4xl dark:text-white">
                Posts de { autor.nombre }
            </h1>

			<div class="grid grid-cols-1 gap-8 mt-8 md:mt-16 md:grid-cols-2">
				{ blogPosts.map( (post) => <BlogPost post={post} /> ) }
			</div>
		</div>
	</section>
</MainLayout>